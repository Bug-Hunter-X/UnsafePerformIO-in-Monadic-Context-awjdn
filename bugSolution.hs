The solution avoids using `unsafePerformIO` altogether. Instead, it leverages pure functions and monadic operations to maintain referential transparency and predictable behavior. This approach enhances the code's reliability and makes it easier to reason about.  The use of the `State` monad is just one option; other monads like `IO` or custom monads might be suitable depending on the specific application.